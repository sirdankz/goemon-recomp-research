<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Action6 System | Goemon Recomp Research</title>
  <link rel="stylesheet" href="./assets/style.css"/>
</head>
<body>
<header>
  <div class="wrap">
    <div class="brand">
      <div class="badge"><span class="dot"></span> UPDATED notes</div>
      <div>
        <h1>Action6 System</h1>
        <div class="subtitle">ctx+0x60 tables → dispatch → jr jump-table</div>
      </div>
    </div>
  </div>
</header>

<div class="wrap">
  <main>
    <nav>
      <div class="navhead">
        <input id="navSearch" placeholder="Filter pages…" />
      </div>
      <ul>
        <li><a href="index.html" data-title="Home">Home</a></li>
        <li><a href="systems_overview.html" data-title="Systems Overview">Systems Overview</a></li>
        <li><a href="door_transition_system.html" data-title="Door Transition System">Door Transition System</a></li>
        <li><a href="action6_system.html" data-title="Action6 System">Action6 System</a></li>
        <li><a href="scheduler_coroutines.html" data-title="Scheduler & Coroutines">Scheduler & Coroutines</a></li>
        <li><a href="workflows_rules.html" data-title="Workflows & Rules">Workflows & Rules</a></li>
        <li><a href="tooling_gotchas.html" data-title="Tooling Gotchas">Tooling Gotchas</a></li>
        <li><a href="scripts.html" data-title="Scripts">Scripts</a></li>
        <li><a href="evidence_pack_format.html" data-title="Evidence Pack Format">Evidence Pack Format</a></li>
        <li><a href="glossary.html" data-title="Glossary">Glossary</a></li>
      </ul>
    </nav>

    <article>
      <div class="content">
        
<h2>Action6 System</h2>
<p class="meta">Verified: wrappers load tables using <code>ctx+0x60</code>, call <code>FUN_801E54E0</code>, then execution tail-jumps via a jr jump-table.</p>

<h3>Index & wrappers</h3>
<ul>
  <li><b>Index byte:</b> <code>ctx+0x60</code> (u8) selects handler entry</li>
  <li>Wrapper call sites:
    <ul>
      <li><code>0x801E132C</code></li>
      <li><code>0x801E13D0</code></li>
      <li><code>0x801E1414</code></li>
    </ul>
  </li>
</ul>

<h3>Tables</h3>
<ul>
  <li><code>0x80204340</code> : a1 table (index*4)</li>
  <li><code>0x80204370</code>, <code>0x80204350</code>, <code>0x80204390</code> : companion tables (a2 / params)</li>
</ul>

<h3>Dispatch</h3>
<ul>
  <li><code>FUN_801E54E0</code> (dispatch window 0x801E5400..0x801E5800) contains no <code>jalr/jr t9</code> — handler execution occurs elsewhere</li>
  <li>jr-table dispatch candidate at <code>0x801E70D0</code>:
    <pre>sll t7, v0, 2
lui at, 0x8021
addu at, at, t7
lw  t7, -0x4A50(at)   ; table base ≈ 0x8020B5B0
jr  t7</pre>
  </li>
  <li>Inferred jump-table base: <code>0x8020B5B0</code>, count=6</li>
</ul>

<h3>Known writer functions</h3>
<ul>
  <li><code>FUN_801ED968</code> (state machine using ctx+0x61 subindex + counters)</li>
  <li><code>FUN_801EAC24</code></li>
  <li><code>FUN_801EA0D8</code> (explicitly sets index=1)</li>
</ul>

<h3>Heuristic: orphan function-pointer table</h3>
<p>
Table at <code>0x80204870</code> had 0 xrefs in our snapshot, but still contains valid function pointers.
That’s useful for automation: scan for pointer tables even if xrefs are missing (gp-relative access, indirect construction).
</p>

        <footer>Last updated: 2025-12-29. Repo: <a href="../">goemon-recomp-research</a></footer>
      </div>
    </article>
  </main>
</div>

<script src="./assets/app.js"></script>
</body>
</html>
